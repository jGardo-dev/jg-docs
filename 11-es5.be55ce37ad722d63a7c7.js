!function(){function t(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||e(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"7DJ4":function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var r,o=n("Fz9N"),c=n("z6cu"),u=n("LRne"),s=n("lJxs"),f=n("bOdf"),l=n("vkgz"),h=n("HDdC"),b=function t(e,n,r,i,o,c){a(this,t),this.name=e,this.path=n,this.dataSource=r,this.type=i,this.entries=o,this.loadMoreEntries=c,this.entries=this.entries||[],c||(this.loadMoreEntries=null)},y=function t(e,n){a(this,t),this.fileSystemEntry=e,this.content=n},d=function(){function t(e,n){a(this,t),this.dataSource=e,this.bitbucketClient=n}return i(t,[{key:"getDataSource",value:function(){return this.dataSource}},{key:"resolvePath",value:function(t){var e=this;return this.bitbucketClient.resolvePath(t).pipe(Object(s.a)((function(n){return e.createFileSystemEntry(t,n)})))}},{key:"createFileSystemEntry",value:function(t,e){var n=e.data;""!==t&&"/"===t.charAt(0)||(t="/"+t);var r=t.substr(t.lastIndexOf("/")+1);if(n.values){var i=this.createEntries(n.values),a=this.createNextPage(n,t);return new b(r,t,this.dataSource,"DIRECTORY",i,a)}return new b(r,t,this.dataSource,"FILE",[])}},{key:"createEntries",value:function(t){var e=this;return t.map((function(t){var n=t.path.substr(t.path.lastIndexOf("/")+1),r=null;return"commit_directory"===t.type?r="DIRECTORY":"commit_file"===t.type&&(r="FILE"),new b(n,"/"+t.path,e.dataSource,r)}))}},{key:"createNextPage",value:function(t,e){var n=this,r=t.next&&new URL(t.next);return t.next&&r.searchParams.has("page")?function(){return new h.a((function(t){var i=r.searchParams.get("page");n.bitbucketClient.resolvePath(e,i).pipe(Object(s.a)((function(t){return n.createFileSystemEntry(e,t)}))).subscribe((function(e){t.next(e),t.complete()}),(function(e){return t.error(e)}))}))}:null}},{key:"resolveFile",value:function(t){var e=this;return this.bitbucketClient.resolvePath(t).pipe(Object(s.a)((function(n){var r=e.createFileSystemEntry(t,n);if("FILE"!==r.type)throw new Error("This is not a file!!!");return new y(r,n.data)})))}},{key:"refresh",value:function(){return this.bitbucketClient.refresh().pipe(Object(s.a)((function(){})))}}]),t}(),v=n("fXoL"),p=n("4HZ0"),m=((r=function(){function t(e){a(this,t),this.bitbucketService=e,this.facadesById={}}return i(t,[{key:"get",value:function(t){var e=this;return null===t?Object(c.a)("Id cannot be null"):this.bitbucketService.list().pipe(Object(s.a)((function(t){return t.map((function(t){return new o.a("bb-".concat(t.workspace.name,"-").concat(t.repository.name),"".concat(t.workspace.name,"/").concat(t.repository.name),"BITBUCKET",t)}))})),Object(f.a)((function(n){var r=n.find((function(e){return e.id===t}));return r&&"BITBUCKET"===r.type?e.facadesById[t]?Object(u.a)(e.facadesById[t]):e.bitbucketService.createBitbucketClient(r.config).pipe(Object(l.a)((function(n){setTimeout((function(){e.facadesById[t]=null}),n.expiresIn)})),Object(s.a)((function(t){return new d(r,t)})),Object(l.a)((function(n){e.facadesById[t]=n}))):Object(c.a)("unknown datasource: "+r)})))}},{key:"refresh",value:function(t){var e=this;return t.refresh().pipe(Object(f.a)((function(){return e.facadesById[t.getDataSource().id]=t,e.bitbucketService.refresh(t.getDataSource().config)})))}}]),t}()).\u0275fac=function(t){return new(t||r)(v.Vb(p.a))},r.\u0275prov=v.Kb({token:r,factory:r.\u0275fac,providedIn:"root"}),r)},"I/6E":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("nYR2"),o=n("fXoL"),c=function(){var t=function(){function t(){a(this,t)}return i(t,[{key:"finishRefresher",value:function(t){return Object(r.a)((function(){t.target.complete()}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},MWW1:function(e,n,r){"use strict";r.r(n),r.d(n,"FileSystemPageModule",(function(){return x}));var o=r("TEn/"),c=r("ofXK"),u=r("3Pt+"),s=r("tyNb"),f=r("z6cu"),l=r("Cfvw"),h=r("vkgz"),b=r("JIr8"),y=r("bOdf"),d=r("fXoL"),v=r("YZAu"),p=r("I/6E"),m=r("7DJ4");function S(t,e){if(1&t){var n=d.Sb();d.Rb(0,"ion-item",8),d.Zb("click",(function(){return d.hc(n),d.bc().goBack()})),d.Pb(1,"ion-icon",9),d.Rb(2,"ion-label"),d.pc(3,".."),d.Qb(),d.Qb()}if(2&t){var r=d.bc();d.ec("routerLink",r.backPath())}}function g(t,e){1&t&&d.Pb(0,"ion-icon",9)}function k(t,e){1&t&&d.Pb(0,"ion-icon",12)}function E(t,e){if(1&t){var n=d.Sb();d.Rb(0,"ion-item",8),d.Zb("click",(function(){d.hc(n);var t=e.$implicit;return d.bc().goToItem(t)})),d.nc(1,g,1,0,"ion-icon",10),d.nc(2,k,1,0,"ion-icon",11),d.Rb(3,"ion-label"),d.pc(4),d.Qb(),d.Qb()}if(2&t){var r=e.$implicit,i=d.bc();d.ec("routerLink",i.itemPath(r)),d.Eb(1),d.ec("ngIf","DIRECTORY"===r.type),d.Eb(1),d.ec("ngIf","FILE"===r.type),d.Eb(2),d.qc(r.name)}}var w,I,O,P,F=((w=function(){function e(t,n,r,i,o){a(this,e),this.route=t,this.router=n,this.toastService=r,this.refresherService=i,this.fileSystemFacadeCacheService=o,this.nextPage=null}return i(e,[{key:"ngOnInit",value:function(){var t=this;this.routeDataSubscription=this.route.data.subscribe((function(e){t.fileSystemEntry=e.fileSystemEntry,t.fileSystemFacade=e.fileSystemFacade,t.nextPage=t.fileSystemEntry.loadMoreEntries}))}},{key:"ngAfterViewInit",value:function(){var t=this;this.routeDataSubscription=this.route.data.subscribe((function(){t.infiniteScroll.disabled=!t.fileSystemEntry.loadMoreEntries}))}},{key:"ngOnDestroy",value:function(){this.routeDataSubscription.unsubscribe()}},{key:"goToItem",value:function(t){this.router.navigate(this.itemPath(t))}},{key:"itemPath",value:function(t){var e=t.path.substr(1).split("/"),n=this.getFileSystemPrefix();return e[e.length-1]=e[e.length-1]+("FILE"===t.type?"-details":""),[n].concat(e)}},{key:"goBack",value:function(){this.router.navigate(this.backPath())}},{key:"backPath",value:function(){var t=this.fileSystemEntry.path.substr(0,this.fileSystemEntry.path.lastIndexOf("/")).substr(1).split("/");return[this.getFileSystemPrefix()].concat(t)}},{key:"getFileSystemPrefix",value:function(){return"/tabs/home/file-system/"+this.fileSystemEntry.dataSource.id}},{key:"loadData",value:function(e){var n=this;this.nextPage().pipe(Object(h.a)((function(r){var i;n.nextPage=r.loadMoreEntries,(i=n.fileSystemEntry.entries).push.apply(i,t(r.entries)),e.target.complete(),n.nextPage||(e.target.disabled=!0)})),this.toastService.catchErrorAndShowToast(),Object(b.a)((function(t){return e.target.complete(),Object(f.a)(t)}))).subscribe()}},{key:"doRefresh",value:function(t){var e=this;this.fileSystemFacadeCacheService.refresh(this.fileSystemFacade).pipe(Object(y.a)((function(){var t=e.fileSystemEntry.path.split("/");return Object(l.a)(e.router.navigate([e.getFileSystemPrefix()].concat(t),{skipLocationChange:!0,state:{refreshTime:new Date}}))})),this.refresherService.finishRefresher(t),this.toastService.catchErrorAndShowToast()).subscribe()}}]),e}()).\u0275fac=function(t){return new(t||w)(d.Ob(s.a),d.Ob(s.g),d.Ob(v.a),d.Ob(p.a),d.Ob(m.a))},w.\u0275cmp=d.Ib({type:w,selectors:[["app-file-system"]],viewQuery:function(t,e){var n;1&t&&d.sc(o.m,!0),2&t&&d.gc(n=d.ac())&&(e.infiniteScroll=n.first)},decls:16,vars:6,consts:[[3,"translucent"],["icon","folder"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],["detail","",3,"routerLink","click",4,"ngIf"],["detail","",3,"routerLink","click",4,"ngFor","ngForOf"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","bubbles","loadingText","Wczytuj\u0119 wi\u0119cej danych..."],["detail","",3,"routerLink","click"],["name","folder","slot","start"],["name","folder","slot","start",4,"ngIf"],["name","document","slot","start",4,"ngIf"],["name","document","slot","start"]],template:function(t,e){1&t&&(d.Rb(0,"ion-header",0),d.Rb(1,"ion-toolbar"),d.Rb(2,"ion-title"),d.Pb(3,"ion-icon",1),d.Rb(4,"ion-label"),d.pc(5),d.Qb(),d.Qb(),d.Qb(),d.Qb(),d.Rb(6,"ion-content",2),d.Rb(7,"ion-refresher",3),d.Zb("ionRefresh",(function(t){return e.doRefresh(t)})),d.Pb(8,"ion-refresher-content"),d.Qb(),d.Rb(9,"ion-list"),d.Rb(10,"ion-list-header"),d.pc(11," Lista plik\xf3w: "),d.Qb(),d.nc(12,S,4,1,"ion-item",4),d.nc(13,E,5,4,"ion-item",5),d.Qb(),d.Rb(14,"ion-infinite-scroll",6),d.Zb("ionInfinite",(function(t){return e.loadData(t)})),d.Pb(15,"ion-infinite-scroll-content",7),d.Qb(),d.Qb()),2&t&&(d.ec("translucent",!0),d.Eb(5),d.rc(" /",e.fileSystemEntry.dataSource.id,"",null==e.fileSystemEntry?null:e.fileSystemEntry.path," "),d.Eb(1),d.ec("fullscreen",!0),d.Eb(6),d.ec("ngIf","/"!==e.fileSystemEntry.path),d.Eb(1),d.ec("ngForOf",null==e.fileSystemEntry?null:e.fileSystemEntry.entries))},directives:[o.k,o.G,o.F,o.l,o.s,o.h,o.v,o.w,o.t,o.u,c.i,c.h,o.m,o.n,o.o,o.L,s.h],styles:[""]}),w),j=r("Yn41"),R=[{path:":fileSystemId",children:[{matcher:function(t,e,n){return t.length>0&&t[t.length-1].path.endsWith("-details")?{consumed:[]}:null},loadChildren:function(){return r.e(12).then(r.bind(null,"3pp/")).then((function(t){return t.FilePageModule}))}},{path:"**",component:F,runGuardsAndResolvers:"always",resolve:{fileSystemFacade:j.a,fileSystemEntry:(I=function(){function t(e,n){a(this,t),this.toastService=e,this.fileSystemFacadeResolverService=n}return i(t,[{key:"resolve",value:function(t,e){var n=this,r=t.url.map((function(t){return t.path})).join("/"),i=r.endsWith("-details")?r.substr(0,r.length-"-details".length):r,a={};return this.fileSystemFacadeResolverService.resolve(t,e).pipe(Object(y.a)((function(t){return n.resolveForUrlAndParamMap(t,i,a)})),this.toastService.catchErrorAndShowToast())}},{key:"resolveForUrlAndParamMap",value:function(t,e,n){return t.resolvePath(e)}}]),t}(),I.\u0275fac=function(t){return new(t||I)(d.Vb(v.a),d.Vb(j.a))},I.\u0275prov=d.Kb({token:I,factory:I.\u0275fac,providedIn:"root"}),I)}}]}],C=((O=function t(){a(this,t)}).\u0275mod=d.Mb({type:O}),O.\u0275inj=d.Lb({factory:function(t){return new(t||O)},imports:[[s.i.forChild(R)],s.i]}),O),T=r("5M1D"),x=((P=function t(){a(this,t)}).\u0275mod=d.Mb({type:P}),P.\u0275inj=d.Lb({factory:function(t){return new(t||P)},imports:[[o.H,c.b,u.a,C,T.a]]}),P)},YZAu:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("JIr8"),o=n("z6cu"),c=n("fXoL"),u=n("TEn/"),s=function(){var t=function(){function t(e){a(this,t),this.toastController=e}return i(t,[{key:"catchErrorAndShowToast",value:function(){var t=this;return Object(r.a)((function(e){return t.showErrorToast(),Object(o.a)(e)}))}},{key:"showErrorToast",value:function(){this.toastController.create({message:"Co\u015b posz\u0142o nie tak...",duration:700}).then((function(t){t.present().then()}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(c.Vb(u.M))},t.\u0275prov=c.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},Yn41:function(t,n,r){"use strict";r.d(n,"a",(function(){return s}));var o=r("fXoL"),c=r("YZAu"),u=r("7DJ4"),s=function(){var t=function(){function t(e,n){a(this,t),this.toastService=e,this.fileSystemFacadeCacheService=n}return i(t,[{key:"resolve",value:function(t,n){var r,i=n.url.endsWith("-details")?n.url.substr(0,n.url.length-"-details".length):n.url,a={},o=function(t,n){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=e(t))||n&&t&&"number"==typeof t.length){r&&(t=r);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,u=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return c=t.done,t},e:function(t){u=!0,o=t},f:function(){try{c||null==r.return||r.return()}finally{if(u)throw o}}}}(t.paramMap.keys);try{for(o.s();!(r=o.n()).done;){var c=r.value;a[c]=t.paramMap.get(c)}}catch(u){o.e(u)}finally{o.f()}return this.resolveForUrlAndParamMap(i,a).pipe(this.toastService.catchErrorAndShowToast())}},{key:"resolveForUrlAndParamMap",value:function(t,e){return this.fileSystemFacadeCacheService.get(e.fileSystemId)}}]),t}();return t.\u0275fac=function(e){return new(e||t)(o.Vb(c.a),o.Vb(u.a))},t.\u0275prov=o.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},z6cu:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("HDdC");function i(t,e){return new r.a(e?function(n){return e.schedule(a,0,{error:t,subscriber:n})}:function(e){return e.error(t)})}function a(t){var e=t.error;t.subscriber.error(e)}}}])}();